<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Learn from MVP: Minimal Instruction Set CPU | Xi&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Introduction
The 6502 CPU program has been a great inspiration for understanding the foundations of computer science. It&rsquo;s fascinating how basic boolean functions and transistors can form such a complex and beautiful system. However, even the 6502 CPU, with its 150&#43; instructions, can be overwhelming for those trying to understand the fundamental principles of computing.
The Importance of Minimal Viable Products
When learning complex systems, it&rsquo;s crucial to start with a minimal viable product (MVP) - understanding the most essential components that make a program run. This approach led me to explore foundational theories and historical concepts in computing.">
<meta name="author" content="Xi Chen">
<link rel="canonical" href="https://xichen1997.github.io/posts/2025-05-30-learn-from-mvp-minimal-instruction-set-cpu/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.56bf4be95d09faf55cd507c845718ccfcabb2e24e37f8fa5a66f9fa098252b06.css" integrity="sha256-Vr9L6V0J&#43;vVc1QfIRXGMz8q7LiTjf4&#43;lpm&#43;foJglKwY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://xichen1997.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://xichen1997.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://xichen1997.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://xichen1997.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://xichen1997.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://xichen1997.github.io/posts/2025-05-30-learn-from-mvp-minimal-instruction-set-cpu/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
};

window.addEventListener('load', (event) => {
    document.querySelectorAll("mjx-container").forEach(function(x){
      x.parentElement.classList += 'has-jax'})
  });
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<meta property="og:url" content="https://xichen1997.github.io/posts/2025-05-30-learn-from-mvp-minimal-instruction-set-cpu/">
  <meta property="og:site_name" content="Xi&#39;s Blog">
  <meta property="og:title" content="Learn from MVP: Minimal Instruction Set CPU">
  <meta property="og:description" content="Introduction The 6502 CPU program has been a great inspiration for understanding the foundations of computer science. It’s fascinating how basic boolean functions and transistors can form such a complex and beautiful system. However, even the 6502 CPU, with its 150&#43; instructions, can be overwhelming for those trying to understand the fundamental principles of computing.
The Importance of Minimal Viable Products When learning complex systems, it’s crucial to start with a minimal viable product (MVP) - understanding the most essential components that make a program run. This approach led me to explore foundational theories and historical concepts in computing.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-30T00:05:00+00:00">
    <meta property="article:modified_time" content="2025-05-30T00:05:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Learn from MVP: Minimal Instruction Set CPU">
<meta name="twitter:description" content="Introduction
The 6502 CPU program has been a great inspiration for understanding the foundations of computer science. It&rsquo;s fascinating how basic boolean functions and transistors can form such a complex and beautiful system. However, even the 6502 CPU, with its 150&#43; instructions, can be overwhelming for those trying to understand the fundamental principles of computing.
The Importance of Minimal Viable Products
When learning complex systems, it&rsquo;s crucial to start with a minimal viable product (MVP) - understanding the most essential components that make a program run. This approach led me to explore foundational theories and historical concepts in computing.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://xichen1997.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Learn from MVP: Minimal Instruction Set CPU",
      "item": "https://xichen1997.github.io/posts/2025-05-30-learn-from-mvp-minimal-instruction-set-cpu/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Learn from MVP: Minimal Instruction Set CPU",
  "name": "Learn from MVP: Minimal Instruction Set CPU",
  "description": "Introduction The 6502 CPU program has been a great inspiration for understanding the foundations of computer science. It\u0026rsquo;s fascinating how basic boolean functions and transistors can form such a complex and beautiful system. However, even the 6502 CPU, with its 150+ instructions, can be overwhelming for those trying to understand the fundamental principles of computing.\nThe Importance of Minimal Viable Products When learning complex systems, it\u0026rsquo;s crucial to start with a minimal viable product (MVP) - understanding the most essential components that make a program run. This approach led me to explore foundational theories and historical concepts in computing.\n",
  "keywords": [
    
  ],
  "articleBody": "Introduction The 6502 CPU program has been a great inspiration for understanding the foundations of computer science. It’s fascinating how basic boolean functions and transistors can form such a complex and beautiful system. However, even the 6502 CPU, with its 150+ instructions, can be overwhelming for those trying to understand the fundamental principles of computing.\nThe Importance of Minimal Viable Products When learning complex systems, it’s crucial to start with a minimal viable product (MVP) - understanding the most essential components that make a program run. This approach led me to explore foundational theories and historical concepts in computing.\nTuring’s Influence Alan Turing’s computational theory provides a perfect starting point. His concept of a universal computing machine demonstrates that any computable problem can be solved using a simple machine with:\nAn infinite length tape A read/write head Basic operations (read, write, logic, and arithmetic) Position control While we can’t implement an infinite tape, we can create a system that operates in a loop, simulating this fundamental concept.\nExtension reading on Turing’s theory: We have to compute the number, then the number should be computable. It seems the word “computable” is vague, so he gave a definition: A real number is computable if a mechanical procedure can print its digits one-by-one in finite time per digit. Replace “print a digit” with “return a value” and you have a computable (partial) function.\nThe probe can be seen as a finite-states machine, which react only on limited states to do some “computation”, which can be defined by limited and concrete steps.\nEncode a TM’s state table as an integer (its ⟨code⟩).\nA Universal TM U takes (⟨M⟩, x) and simulates M running on input x. Legacy. “Program = data” → the von Neumann architecture, data can be control message(finite state) or information; Figure 1: A simplified representation of a Turing Machine\nMinimal Instruction Set Design Based on these principles, a minimal CPU needs only four types of instructions:\nJMP (Jump) - For program flow control Logic - For basic boolean operations ADD/SUB - For arithmetic operations (multiplication and division can be simulated) HALT - To stop program execution CPU Specification After careful consideration and consultation, here’s the design for our minimal CPU:\nMemory and Registers RAM: 64KB (65536 bytes) with 16-bit addressing Registers: 4 general-purpose 8-bit registers (R0-R3) Program Counter (PC): 16-bit register for instruction fetching Instruction Set Opcode Instruction Description 0x00 HALT Stops program execution 0x01 LOAD Loads data from memory into register 0x02 STORE Stores register value into memory 0x03 ADD Adds two register values 0x04 SUB Subtracts two register values 0x05 JNZ Jump if register is not zero CPU Operation Cycle The CPU follows a simple fetch-execute cycle:\nFetch instruction from memory at PC Decode instruction Execute instruction Update PC Repeat until HALT Look how cpu borrow the concept from Turing Machine:\nComponent Role Modern analogue Unbounded tape Program + data store RAM + disk Read/write head Pointer \u0026 ALU CPU register Finite state table Control logic Instruction set This minimal setup provides the foundation for basic logic and arithmetic operations, which can be extended to handle more complex tasks.\nImplementation CPU Header (cpu.h) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 #pragma once #include #include #include #include class MinimalCPU { public: uint8_t RAM[65536]{}; uint8_t R[4] = {0}; // R0 ~ R3 uint16_t PC = 0; bool halted = false; // Load program into memory void loadProgram(const std::vector\u003cuint8_t\u003e\u0026 program, uint16_t start = 0) { for (size_t i = 0; i \u003c program.size(); ++i) { RAM[start + i] = program[i]; } PC = start; } // Main CPU execution loop void run() { while (!halted) { uint8_t op = fetch(); switch (op) { case 0x00: // HALT halted = true; break; case 0x01: { // LOAD Rd, addr uint8_t rd = fetch(); uint16_t addr = (fetch() \u003c\u003c 8) | fetch(); R[rd] = RAM[addr]; break; } case 0x02: { // STORE addr, Rs uint16_t addr = (fetch() \u003c\u003c 8) | fetch(); uint8_t rs = fetch(); RAM[addr] = R[rs]; // Special handling for output port if (addr == 0xFF00) { std::cout \u003c\u003c \"OUTPUT: \" \u003c\u003c static_cast\u003cchar\u003e(RAM[addr]) \u003c\u003c \"\\n\"; } break; } case 0x03: { // ADD Rd, Rs uint8_t rd = fetch(); uint8_t rs = fetch(); R[rd] += R[rs]; break; } case 0x04: { // SUB Rd, Rs uint8_t rd = fetch(); uint8_t rs = fetch(); R[rd] -= R[rs]; break; } case 0x05: { // JNZ Rd, addr uint8_t rd = fetch(); uint16_t addr = (fetch() \u003c\u003c 8) | fetch(); if (R[rd] != 0) { PC = addr; } break; } default: std::cerr \u003c\u003c \"Unknown opcode: \" \u003c\u003c std::hex \u003c\u003c static_cast\u003cint\u003e(op) \u003c\u003c \"\\n\"; halted = true; break; } } } private: uint8_t fetch() { return RAM[PC++]; } }; Test Program (main.cpp) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 #include \"cpu.h\" #include int main() { MinimalCPU cpu; // Test program: Load 'A' from memory and output it std::vector\u003cuint8_t\u003e program = { 0x01, 0x00, 0x00, 0xFA, // LOAD R0, 0x00FA 0x02, 0xFF, 0x00, 0x00, // STORE 0xFF00, R0 0x00 // HALT }; cpu.RAM[0x00FA] = 'A'; // Set test data cpu.loadProgram(program); cpu.run(); return 0; } Conclusion This minimal CPU implementation demonstrates the fundamental principles of computing while remaining accessible and understandable. It provides a foundation that can be extended to create more complex systems, making it an excellent learning tool for understanding computer architecture.\nGitHub Repository View the complete implementation on GitHub\n",
  "wordCount" : "984",
  "inLanguage": "en",
  "datePublished": "2025-05-30T00:05:00Z",
  "dateModified": "2025-05-30T00:05:00Z",
  "author":{
    "@type": "Person",
    "name": "Xi Chen"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://xichen1997.github.io/posts/2025-05-30-learn-from-mvp-minimal-instruction-set-cpu/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Xi's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://xichen1997.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://xichen1997.github.io/" accesskey="h" title="Xi&#39;s Blog (Alt + H)">Xi&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://xichen1997.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://xichen1997.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://xichen1997.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://xichen1997.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://xichen1997.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Learn from MVP: Minimal Instruction Set CPU
    </h1>
    <div class="post-meta"><span title='2025-05-30 00:05:00 +0000 +0000'>May 30, 2025</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span>984 words</span>&nbsp;·&nbsp;<span>Xi Chen</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#the-importance-of-minimal-viable-products">The Importance of Minimal Viable Products</a></li>
    <li><a href="#turings-influence">Turing&rsquo;s Influence</a></li>
    <li><a href="#extension-reading-on-turings-theory">Extension reading on Turing&rsquo;s theory:</a></li>
    <li><a href="#minimal-instruction-set-design">Minimal Instruction Set Design</a></li>
    <li><a href="#cpu-specification">CPU Specification</a>
      <ul>
        <li><a href="#memory-and-registers">Memory and Registers</a></li>
        <li><a href="#instruction-set">Instruction Set</a></li>
        <li><a href="#cpu-operation-cycle">CPU Operation Cycle</a></li>
      </ul>
    </li>
    <li><a href="#implementation">Implementation</a>
      <ul>
        <li><a href="#cpu-header-cpuh">CPU Header (cpu.h)</a></li>
        <li><a href="#test-program-maincpp">Test Program (main.cpp)</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#github-repository">GitHub Repository</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>The 6502 CPU program has been a great inspiration for understanding the foundations of computer science. It&rsquo;s fascinating how basic boolean functions and transistors can form such a complex and beautiful system. However, even the 6502 CPU, with its 150+ instructions, can be overwhelming for those trying to understand the fundamental principles of computing.</p>
<h2 id="the-importance-of-minimal-viable-products">The Importance of Minimal Viable Products<a hidden class="anchor" aria-hidden="true" href="#the-importance-of-minimal-viable-products">#</a></h2>
<p>When learning complex systems, it&rsquo;s crucial to start with a minimal viable product (MVP) - understanding the most essential components that make a program run. This approach led me to explore foundational theories and historical concepts in computing.</p>
<h2 id="turings-influence">Turing&rsquo;s Influence<a hidden class="anchor" aria-hidden="true" href="#turings-influence">#</a></h2>
<p>Alan Turing&rsquo;s computational theory provides a perfect starting point. His concept of a universal computing machine demonstrates that any computable problem can be solved using a simple machine with:</p>
<ul>
<li>An infinite length tape</li>
<li>A read/write head</li>
<li>Basic operations (read, write, logic, and arithmetic)</li>
<li>Position control</li>
</ul>
<p>While we can&rsquo;t implement an infinite tape, we can create a system that operates in a loop, simulating this fundamental concept.</p>
<h2 id="extension-reading-on-turings-theory">Extension reading on Turing&rsquo;s theory:<a hidden class="anchor" aria-hidden="true" href="#extension-reading-on-turings-theory">#</a></h2>
<p>We have to compute the number, then the number should be computable. It seems the word &ldquo;computable&rdquo; is vague, so he gave a definition:
<em>A real number is computable if a mechanical procedure can print its digits one-by-one in finite time per digit. Replace &ldquo;print a digit&rdquo; with &ldquo;return a value&rdquo; and you have a computable (partial) function.</em></p>
<p>The probe can be seen as a finite-states machine, which react only on limited states to do some &ldquo;computation&rdquo;, which can be defined by limited and concrete steps.</p>
<p>Encode a TM&rsquo;s state table as an integer (its ⟨code⟩).</p>
<ul>
<li>A Universal TM U takes (⟨M⟩, x) and simulates M running on input x.
Legacy.</li>
<li>&ldquo;Program = data&rdquo; → the von Neumann architecture, data can be control message(finite state) or information;</li>
</ul>
<p><img alt="Turing Machine Diagram" loading="lazy" src="/assets/images/turing-machine.png">
<em>Figure 1: A simplified representation of a Turing Machine</em></p>
<h2 id="minimal-instruction-set-design">Minimal Instruction Set Design<a hidden class="anchor" aria-hidden="true" href="#minimal-instruction-set-design">#</a></h2>
<p>Based on these principles, a minimal CPU needs only four types of instructions:</p>
<ol>
<li><strong>JMP</strong> (Jump) - For program flow control</li>
<li><strong>Logic</strong> - For basic boolean operations</li>
<li><strong>ADD/SUB</strong> - For arithmetic operations (multiplication and division can be simulated)</li>
<li><strong>HALT</strong> - To stop program execution</li>
</ol>
<h2 id="cpu-specification">CPU Specification<a hidden class="anchor" aria-hidden="true" href="#cpu-specification">#</a></h2>
<p>After careful consideration and consultation, here&rsquo;s the design for our minimal CPU:</p>
<h3 id="memory-and-registers">Memory and Registers<a hidden class="anchor" aria-hidden="true" href="#memory-and-registers">#</a></h3>
<ul>
<li><strong>RAM</strong>: 64KB (65536 bytes) with 16-bit addressing</li>
<li><strong>Registers</strong>: 4 general-purpose 8-bit registers (R0-R3)</li>
<li><strong>Program Counter (PC)</strong>: 16-bit register for instruction fetching</li>
</ul>
<h3 id="instruction-set">Instruction Set<a hidden class="anchor" aria-hidden="true" href="#instruction-set">#</a></h3>
<table>
  <thead>
      <tr>
          <th style="text-align: center">Opcode</th>
          <th style="text-align: left">Instruction</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">0x00</td>
          <td style="text-align: left">HALT</td>
          <td style="text-align: left">Stops program execution</td>
      </tr>
      <tr>
          <td style="text-align: center">0x01</td>
          <td style="text-align: left">LOAD</td>
          <td style="text-align: left">Loads data from memory into register</td>
      </tr>
      <tr>
          <td style="text-align: center">0x02</td>
          <td style="text-align: left">STORE</td>
          <td style="text-align: left">Stores register value into memory</td>
      </tr>
      <tr>
          <td style="text-align: center">0x03</td>
          <td style="text-align: left">ADD</td>
          <td style="text-align: left">Adds two register values</td>
      </tr>
      <tr>
          <td style="text-align: center">0x04</td>
          <td style="text-align: left">SUB</td>
          <td style="text-align: left">Subtracts two register values</td>
      </tr>
      <tr>
          <td style="text-align: center">0x05</td>
          <td style="text-align: left">JNZ</td>
          <td style="text-align: left">Jump if register is not zero</td>
      </tr>
  </tbody>
</table>
<h3 id="cpu-operation-cycle">CPU Operation Cycle<a hidden class="anchor" aria-hidden="true" href="#cpu-operation-cycle">#</a></h3>
<p>The CPU follows a simple fetch-execute cycle:</p>
<ol>
<li>Fetch instruction from memory at PC</li>
<li>Decode instruction</li>
<li>Execute instruction</li>
<li>Update PC</li>
<li>Repeat until HALT</li>
</ol>
<p>Look how cpu borrow the concept from Turing Machine:</p>
<table>
  <thead>
      <tr>
          <th>Component</th>
          <th>Role</th>
          <th>Modern analogue</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Unbounded tape</td>
          <td>Program + data store</td>
          <td>RAM + disk</td>
      </tr>
      <tr>
          <td>Read/write head</td>
          <td>Pointer &amp; ALU</td>
          <td>CPU register</td>
      </tr>
      <tr>
          <td>Finite state table</td>
          <td>Control logic</td>
          <td>Instruction set</td>
      </tr>
  </tbody>
</table>
<p>This minimal setup provides the foundation for basic logic and arithmetic operations, which can be extended to handle more complex tasks.</p>
<h2 id="implementation">Implementation<a hidden class="anchor" aria-hidden="true" href="#implementation">#</a></h2>
<h3 id="cpu-header-cpuh">CPU Header (cpu.h)<a hidden class="anchor" aria-hidden="true" href="#cpu-header-cpuh">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#pragma once
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstdint&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iomanip&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MinimalCPU</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="n">RAM</span><span class="p">[</span><span class="mi">65536</span><span class="p">]{};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="n">R</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>  <span class="c1">// R0 ~ R3
</span></span></span><span class="line"><span class="cl">    <span class="kt">uint16_t</span> <span class="n">PC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="n">halted</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Load program into memory
</span></span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">loadProgram</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;&amp;</span> <span class="n">program</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">program</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">RAM</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">program</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">PC</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Main CPU execution loop
</span></span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">halted</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">uint8_t</span> <span class="n">op</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">switch</span> <span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="mh">0x00</span><span class="o">:</span> <span class="c1">// HALT
</span></span></span><span class="line"><span class="cl">                    <span class="n">halted</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="mh">0x01</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// LOAD Rd, addr
</span></span></span><span class="line"><span class="cl">                    <span class="kt">uint8_t</span> <span class="n">rd</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">uint16_t</span> <span class="n">addr</span> <span class="o">=</span> <span class="p">(</span><span class="n">fetch</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">R</span><span class="p">[</span><span class="n">rd</span><span class="p">]</span> <span class="o">=</span> <span class="n">RAM</span><span class="p">[</span><span class="n">addr</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="mh">0x02</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// STORE addr, Rs
</span></span></span><span class="line"><span class="cl">                    <span class="kt">uint16_t</span> <span class="n">addr</span> <span class="o">=</span> <span class="p">(</span><span class="n">fetch</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">uint8_t</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">RAM</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">rs</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="c1">// Special handling for output port
</span></span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">addr</span> <span class="o">==</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;OUTPUT: &#34;</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">RAM</span><span class="p">[</span><span class="n">addr</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="mh">0x03</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// ADD Rd, Rs
</span></span></span><span class="line"><span class="cl">                    <span class="kt">uint8_t</span> <span class="n">rd</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">uint8_t</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">R</span><span class="p">[</span><span class="n">rd</span><span class="p">]</span> <span class="o">+=</span> <span class="n">R</span><span class="p">[</span><span class="n">rs</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="mh">0x04</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// SUB Rd, Rs
</span></span></span><span class="line"><span class="cl">                    <span class="kt">uint8_t</span> <span class="n">rd</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">uint8_t</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">R</span><span class="p">[</span><span class="n">rd</span><span class="p">]</span> <span class="o">-=</span> <span class="n">R</span><span class="p">[</span><span class="n">rs</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">case</span> <span class="mh">0x05</span><span class="o">:</span> <span class="p">{</span> <span class="c1">// JNZ Rd, addr
</span></span></span><span class="line"><span class="cl">                    <span class="kt">uint8_t</span> <span class="n">rd</span> <span class="o">=</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">uint16_t</span> <span class="n">addr</span> <span class="o">=</span> <span class="p">(</span><span class="n">fetch</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">fetch</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">rd</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">PC</span> <span class="o">=</span> <span class="n">addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Unknown opcode: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">hex</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">halted</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="n">fetch</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">RAM</span><span class="p">[</span><span class="n">PC</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="test-program-maincpp">Test Program (main.cpp)<a hidden class="anchor" aria-hidden="true" href="#test-program-maincpp">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;cpu.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">MinimalCPU</span> <span class="n">cpu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Test program: Load &#39;A&#39; from memory and output it
</span></span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">program</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span>   <span class="c1">// LOAD R0, 0x00FA
</span></span></span><span class="line"><span class="cl">        <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>   <span class="c1">// STORE 0xFF00, R0
</span></span></span><span class="line"><span class="cl">        <span class="mh">0x00</span>                      <span class="c1">// HALT
</span></span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cpu</span><span class="p">.</span><span class="n">RAM</span><span class="p">[</span><span class="mh">0x00FA</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;A&#39;</span><span class="p">;</span>  <span class="c1">// Set test data
</span></span></span><span class="line"><span class="cl">    <span class="n">cpu</span><span class="p">.</span><span class="n">loadProgram</span><span class="p">(</span><span class="n">program</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cpu</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>This minimal CPU implementation demonstrates the fundamental principles of computing while remaining accessible and understandable. It provides a foundation that can be extended to create more complex systems, making it an excellent learning tool for understanding computer architecture.</p>
<h2 id="github-repository">GitHub Repository<a hidden class="anchor" aria-hidden="true" href="#github-repository">#</a></h2>
<p><a href="https://github.com/xichen1997/minimal_turing_complete_CPU">View the complete implementation on GitHub</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://xichen1997.github.io/posts/2025-07-14-dsl-and-compiler-based-on-minimal-cpu/">
    <span class="title">« Prev</span>
    <br>
    <span>DSL and Compiler Based on Minimal CPU</span>
  </a>
  <a class="next" href="https://xichen1997.github.io/posts/2025-02-27-running-llm-on-mac-mini-clusters-strategy-and-practice/">
    <span class="title">Next »</span>
    <br>
    <span>Running LLM on mac mini clusters, strategy and practice</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://xichen1997.github.io/">Xi&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
